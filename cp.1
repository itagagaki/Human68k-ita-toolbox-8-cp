


CP(1)          Human68k ITA TOOLBOX User's Manual           CP(1)



名称
     cp - ファイルやディレクトリをコピーする

形式
     cp [ -IRVadefinprsuvx ] [ -m expression ] [ -- ] source dest

     cp [ -IPRVadefinprsuvx ] [ -m expression ] [ -- ] source ...
     targetdir

解説
     cp はファイルやディレクトリをコピーします．ファイルからデバ
     イス，デバイスからファイル，およびデバイスからデバイスへのデー
     タ転送も行うことができます．

     第1の形式では source を dest にコピーします．デバイスは，こ
     の形式でのみ指定可能です．第2の形式では source ... をそれぞ
     れ元のファイル名のままディレクトリ targetdir の中にコピーし
     ます．source ... は左から右に順番に処理され，-e オプションが
     指定されていなければ，もし途中でエラーがあっても処理は最後ま
     で続行されます．この 2つの形式は最後の引数がディレクトリ（ま
     たはディレクトリへのシンボリック・リンク）であるかどうかで区
     別されます．

     ‘A:’のようなドライブ名のみの指定は，そのドライブのカレント・
     ディレクトリを意味します．

     ディレクトリをコピーするには，-r オプションかまたは -R オプ
     ションを指定してください．このオプションは，source がディレ
     クトリである場合，そのディレクトリはもちろん，それ以下のすべ
     てのファイルやディレクトリを再帰的にコピーします．

     コピー先の属性は次にように設定されます．

     ・新規ファイル
     ・新規ディレクトリ

          source から属性もコピーされます．source に属性が無い場
          合は，読み書き可，実行不可となります．いずれの場合も -m
          オプションによって変更されます．

     ・既存ファイル

          属性は通常は元のまま保存されますが，-p オプションを指定
          すると，もし source に属性があれば source から属性もコ
          ピーされます．いずれの場合も -m オプションによって変更
          されます．

     ・既存ディレクトリ

          属性は元のまま保存されます．-p オプションや -m オプショ
          ンは無効です．

     コピー先のタイムスタンプは次にように設定されます．

     ・新規ファイル
     ・既存ファイル
     ・新規ディレクトリ

          タイムスタンプは通常は更新されますが，-p オプションを指
          定すると，もし source にタイムスタンプがあれば source
          からタイムスタンプもコピーされます．

     ・既存ディレクトリ

          タイムスタンプは元のまま保存されます．-p オプションは無
          効です．

     cp は沖版 lndrv によるシンボリック・リンク（以下では単に『シ
     ンボリック・リンク』と記します）をサポートしています．-d オ
     プションが指定されていなければ，シンボリック・リンクに対する
     アクセスは，リンクが参照する実体へのアクセスとなります．その
     場合，lndrv がシステムに組み込まれていなければなりません．

     コピー元とコピー先が同一のエントリである場合はエラーとなりま
     す．

     cp には 次のオプションがあります．

     -I             ファイルやディレクトリ毎に問い合わせを行いま
                    す．問い合わせに対して‘y’で始まる行を入力す
                    ると通常どおり処理され，それ以外の入力ではコ
                    ピーをとりやめて次のファイルやディレクトリの
                    処理に進みます．このオプションは -i オプショ
                    ンを覆いますが，コピー先に既にファイルがある
                    場合には -i オプションと同じ処理が行われます．

     -P             たとえば cp -P a/b/c /d/e/f G:/h/i/j dir では，
                    a/b/c を dir/a/b/c に，/d/e/f を dir/d/e/f に，
                    G:/h/i/j を dir/h/i/j にコピーします．dir は
                    存在するディレクトリでなければなりません（こ
                    のオプションは第2の形式でのみサポートされます）．
                    パス dir/a/b，dir/d/e，dir/h/i は，存在しなけ
                    れば作成されます（ただしコピーするファイルが
                    存在していなければ，パスの作成は行われません）．
                    このパスの作成は，どのオプションの影響も受け
                    ません．

     -R, -r         ディレクトリを再帰的にコピーします．

     -V             ボリューム・ラベルもコピーします．

     -a             -dpR と同じです．

     -d             シンボリック・リンクが参照する実体にアクセス
                    する代わりにリンク・ファイルそのものにアクセ
                    スします．シンボリック・リンクは，そのままシ
                    ンボリック・リンクとしてコピーされることにな
                    ります．また，コピー先にシンボリック・リンク
                    が存在している場合は，そのリンク・ファイルが
                    上書きの対象となります．通常これは結果的には
                    エラーとなりますが，-f オプションを指定すれば，
                    コピー先のリンク・ファイルが予め削除され，そ
                    れに代わってコピーが新規作成されることになり
                    ます．

                         このオプションは，cp の 2つの形式の判別
                    （最後の引数がディレクトリであるかどうかの判定）
                    には影響しません．

     -e             何らかのエラーが起こったとき，処理を続行せず
                    に即終了します．

     -f             コピー先にファイルが存在していれば，それを予
                    め強制的に削除して新規に作成します．削除は -u
                    オプションや -i オプションの処理後に行われま
                    す．

     -i             コピー先にファイルが存在している場合に限り，
                    上書きするかどうかを -I オプションと同様に問
                    い合わせます．

                         問い合わせに対して‘y’で始まる行を入力
                    しても，上書きが必ず成功するとは限りません．
                    コピー先に存在するファイルの属性によっては，
                    結果的にエラーとなる場合があります．そのよう
                    な場合も強制的にコピーしたい場合には -f オプ
                    ションを併用してください．この ITA TOOLBOX の
                    cp では，-f オプション と -i オプションは互い
                    に打ち消し合うものではありません．

     -n             -v オプションと同じ報告を行いますが，実際にコ
                    ピーはしません．このオプションを指定すると，
                    -f オプション，-i オプションおよび -I オプショ
                    ンは無効となります．

     -p             ファイルや新規作成されるディレクトリに対して
                    （もしあれば）属性とタイムスタンプもコピーし
                    ます．-m オプションによる修正はその属性に対し
                    て働くことになります．

     -s             ファイル（ディレクトリは除く）をコピーする代
                    わりに，そのファイルを参照するシンボリック・
                    リンクを作成します．ただし，コピー元が相対パ
                    スで示される場合には，コピー先は‘.’（カレン
                    ト・ディレクトリ）でなければなりません．

     -u             ファイル（ディレクトリを除く）をコピーすると
                    き，コピー先にファイルが存在していて，それが
                    コピーしようとするファイルよりも新しければ，
                    コピーしません．その場合には問い合わせも行わ
                    れません．

     -v             ファイルやデバイスをコピーする直前に，そのパ
                    ス名とコピー先を標準出力に出力します．ディレ
                    クトリを作成したときには，その直後に報告しま
                    す．

     -x             ディレクトリを再帰的にコピーするとき，コピー
                    を始める最上位のディレクトリと同じドライブに
                    あるファイルやディレクトリのみをコピーし，違
                    うドライブにあるファイルやディレクトリはコピー
                    しません．その場合には問い合わせも行われませ
                    ん．

     以上のオプションは -u -p のようにそれぞれ単独に記述すること
     もできますし，-up のように連結して指定することもできます．

     -m expression  コピー先のファイルや新たに作成されるディレク
                    トリに本来与えられる属性を expression に従っ
                    て変更します．

                         この機能は ITA TOOLBOX の chmod(1) に準
                    じます．expression は単一の引数でなければなり
                    ません．expression の書式は ITA TOOLBOX の
                    chmod(1) と同じです．

     -m オプションを複数指定した場合には，最後の指定が有効となり
     ます．

     -m オプションは，単独で指定するか，または -um expression の
     ように他のオプションに続けて指定することができますが，-mu の
     ように後ろに他のオプションを連結することはできません．

     引数‘--’は，残りの引数を非オプション引数とします．引数‘-’
     は非オプション引数と見なされます．

関連事項
     ln(1), mv(1), rm(1), mkdir(1), chmod(1)

診断
     何らかのエラーがあったときにはエラー・メッセージが標準エラー
     出力に出力されます．

     終了ステータスとしては，引数の記述に間違いがあった場合には 1，
     各引数の処理中に何らかのエラーが 1度でもあった場合には 2，メ
     モリ不足や OS のバージョンの違いなど，システムの原因により正
     常に実行ができなかった場合には 3，すべてが正常に終了したなら
     ば 0 が返ります．^C などによって中断したときの終了ステータス
     は OS の仕様によります．

注意
     ファイルのコピーに失敗したり，ファイルのコピー中に ^C によっ
     て停止した場合には，コピー先にコピー途中のファイルが残ります．

不具合
     サブディレクトリに別のドライブがjoin（mount）されているとき，
     -x オプションはその別ドライブ内のファイルやディレクトリを無
     視しますが，そのサブディレクトリそのものだけはコピーされます．

     ディレクトリの再帰の回数は64回に制限されています．

バージョン
     1.5

制作・著作
     Copyright(C)1992-93 by 板垣 史彦 (Itagaki Fumihiko)



1.5                 Last change: 17 Feb 1993     Itagaki Fumihiko



